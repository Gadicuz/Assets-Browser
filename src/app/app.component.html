<div class="app-container" fxLayout="column" fxLayoutAlign="start" *defVar="(userTabs$ | async) as tabs">
  <mat-toolbar fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="16px" color="primary" class="mat-elevation-z0 header">
    <ng-container *ngIf="tabs; else nouser">
      <a fxFlex="0 0 auto" mat-stroked-button routerLinkActive="mat-flat-button" [routerLink]="['/browse']">Assets</a>
      <a fxFlex="0 0 auto" mat-stroked-button routerLinkActive="mat-flat-button" [routerLink]="['/orders']">Orders</a>
      <div fxFlex="1 1 auto"></div>
      <div fxFlex="0 0 auto"><span>{{title}}</span></div>
      <mat-tab-group color="warn" selectedIndex="1" (selectedTabChange)="tabChanged($event)">
        <mat-tab *ngFor="let user of tabs">
          <ng-template mat-tab-label>
            <img class="avatar" [src]="user.avatar">
          </ng-template> 
        </mat-tab>
      </mat-tab-group>
    </ng-container>
    <ng-template #nouser>
      <div fxFlex="1 1 auto"></div>
    </ng-template>
    <div *ngIf="isLoggedIn(); then loggedIn; else loggedOut"></div>
    <ng-template #loggedIn>
      <button fxFlex="0 0 auto" mat-icon-button (click)="logoff()" [routerLink]="['/']">
        <mat-icon>exit_to_app</mat-icon>
      </button>
    </ng-template>
    <ng-template #loggedOut>
      <button fxFlex="0 0 auto" mat-button (click)="login()">
        <img src="https://web.ccpgamescdn.com/eveonlineassets/developers/eve-sso-login-white-small.png" />
      </button>
    </ng-template>
  </mat-toolbar>

  <div *ngIf="tabs" fxLayout="row" fxLayoutAlign="center">
    <div fxFlex="80%">
      <router-outlet></router-outlet>
    </div>
  </div>

  <div class="filler" fxFlex fxFlexFill></div>

  <app-error *ngIf="loginError" [err]="loginError"></app-error>

  <div fxFlex class="footer">
    <p class="mat-small">{{copyright}}</p>
  </div>
</div>
